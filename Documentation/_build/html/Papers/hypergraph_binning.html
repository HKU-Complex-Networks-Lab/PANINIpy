<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Binning Temporal Hypergraphs &mdash; PANINIpy: Packageof Algorithms for Nonparametric Inference on Networks in Python  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=5a409b2d" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=5929fcd5"></script>
        <script src="../_static/doctools.js?v=9a2dae69"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Clustering Network Populations" href="population_clustering.html" />
    <link rel="prev" title="Welcome to PANINIpy’s documentation!" href="../index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            PANINIpy: Packageof Algorithms for Nonparametric Inference on Networks in Python
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Methods:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Binning Temporal Hypergraphs</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#tutorial">Tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="#mdl-hypergraph-binning">MDL Hypergraph Binning</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#functions">Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#reference">Reference</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#demo">Demo</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#example-code">Example Code</a></li>
<li class="toctree-l3"><a class="reference internal" href="#example-output">Example Output</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#paper-source">Paper source</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="population_clustering.html">Clustering Network Populations</a></li>
<li class="toctree-l1"><a class="reference internal" href="distributional_regionalization.html">Regionalization with Distributional Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="hub_identification.html">Identifying Network Hubs</a></li>
<li class="toctree-l1"><a class="reference internal" href="community_regionalization.html">Regionalization with Community Detection</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Table of Content:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="paper.html">Summary</a></li>
<li class="toctree-l1"><a class="reference internal" href="paper.html#statement-of-need">Statement of Need</a></li>
<li class="toctree-l1"><a class="reference internal" href="paper.html#related-software-packages">Related Software Packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="paper.html#current-modules">Current Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="paper.html#acknowledgments">Acknowledgments</a></li>
<li class="toctree-l1"><a class="reference internal" href="paper.html#references">References</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">PANINIpy: Packageof Algorithms for Nonparametric Inference on Networks in Python</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Binning Temporal Hypergraphs</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/Papers/hypergraph_binning.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="binning-temporal-hypergraphs">
<h1>Binning Temporal Hypergraphs<a class="headerlink" href="#binning-temporal-hypergraphs" title="Link to this heading"></a></h1>
<section id="tutorial">
<h2>Tutorial<a class="headerlink" href="#tutorial" title="Link to this heading"></a></h2>
<p>Code to perform hypergraph binning method derived in “Inference of dynamic hypergraph representations in temporal interaction data” (Kirkley, 2024, <a class="reference external" href="https://arxiv.org/abs/2308.16546">https://arxiv.org/abs/2308.16546</a>).</p>
<p>Inputs a list containing events between two disjoint node sets, with entries of the form (source node, destination node, weight, time), where:</p>
<ul class="simple">
<li><p><strong>source node:</strong> Node from first set (i.e. a user).</p></li>
<li><p><strong>destination:</strong> Node from second set (i.e. an item purchased by the user).</p></li>
<li><p><strong>weight:</strong> The weight of the event, representing its significance or frequency (i.e. the cost of the item).</p></li>
<li><p><strong>time:</strong> The time at which the event occurs.</p></li>
</ul>
<p>Also inputs a desired resolution dt for time discretzation, and whether to use exact dynamic programming or an approximate greedy method for the inference.</p>
<p>Outputs compression ratio, event clusters, and number of time steps, where:</p>
<ul class="simple">
<li><p><strong>compression ratio:</strong> The ratio of the description length after event binning to the description length of naive transmission.</p></li>
<li><p><strong>event clusters:</strong> A list assigning each event to a temporal cluster label where the events can be aggregated into a weighted hypergraph or bipartite graph.</p></li>
<li><p><strong>number of time steps:</strong> The number of time steps corresponding to the specified width (dt).</p></li>
</ul>
<p>The method minimizes the following nonparametric Minimum Description Length (MDL) clustering objective over 1D segmentations <img class="math" src="../_images/math/0f09e65da7b4cf5a122a1923b520bbdf5cca7700.png" alt="\tau" style="vertical-align: 0px"/>  of the time interval:</p>
<div class="math" id="equation1">
<p><img src="../_images/math/02d543c313045c841ab0fb17fdf71758816f6bab.png" alt="\[
\mathcal{L}_{\text{total}}(\mathcal{X}, \tau) = \sum_{k=1}^{K} \mathcal{L}_{\text{cluster}}^{(k)},
\]"/></p>
</div><p>where</p>
<div class="math" id="equation2">
<p><img src="../_images/math/8e4581fe49bf33a0be203ced3e214523fcfde2ea.png" alt="\[
\mathcal{L}_{\text{cluster}}^{(k)} = \log(N - 1)(T - 1) + \log\left(\binom{S}{m_k}\right)\left(\binom{D}{m_k}\right)\left (\binom{\tau_k}{m_k}\right) + \left[\log \Omega(s^{(k)}, d^{(k)}) + \log \Omega(G^{(k)}, n^{(k)}) \right]
\]"/></p>
</div><p>is the description length of the k-th temporal cluster according to Eq. 14 in <a class="reference external" href="https://arxiv.org/pdf/2308.16546">https://arxiv.org/pdf/2308.16546</a>.</p>
</section>
<section id="mdl-hypergraph-binning">
<h2>MDL Hypergraph Binning<a class="headerlink" href="#mdl-hypergraph-binning" title="Link to this heading"></a></h2>
<p>This module provides functions to calculate the logarithm of binomial and multinomial coefficients, as well as to identify the Minimum Description Length (MDL) configuration for hypergraph binning.</p>
<section id="functions">
<h3>Functions<a class="headerlink" href="#functions" title="Link to this heading"></a></h3>
<p>All of the following functions are provided in this module and have the same general usage as described below.</p>
<table class="docutils align-default" id="id2">
<caption><span class="caption-text">Functions</span><a class="headerlink" href="#id2" title="Link to this table"></a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Function</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference external" href="#logchoose">logchoose(n, k)</a></p></td>
<td><p>Compute the logarithm of the binomial coefficient.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference external" href="#logmult">logmult(counts)</a></p></td>
<td><p>Compute the logarithm of the multinomial coefficient over count data.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference external" href="#logOmega">logOmega(rs, cs, swap=True)</a></p></td>
<td><p>Compute the logarithm of the number of non-negative integer matrices with specified row and column sums.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference external" href="#MDL_hypergraph_binning">MDL_hypergraph_binning(X, dt, exact=True)</a></p></td>
<td><p>Identify the MDL-optimal temporally contiguous partition of event data.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference external" href="#DL">MDL_hypergraph_binning.DL(i, j)</a></p></td>
<td><p>Compute the cluster-level description length.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="reference">
<h3>Reference<a class="headerlink" href="#reference" title="Link to this heading"></a></h3>
<div id="logchoose" class="function-header">
    <span class="class-name">function</span> <span class="function-name">logchoose(n, k)</span>
    <a class="source-link" href="../Code/hypergraph_binning.html#logchoose">[source]</a>
</div><p><strong>Description</strong>:
Compute the logarithm of the binomial coefficient.</p>
<p><strong>Parameters</strong>:</p>
<div class="parameter-block">
    (n, k)
</div>

<ul class="parameter-list">
    <li><span class="param-name">n</span>: Total number of items.</li>
    <li><span class="param-name">k</span>: Number of chosen items.</li>
</ul><dl class="simple">
<dt><strong>Returns</strong>:</dt><dd><ul class="simple">
<li><p><strong>float</strong>: Logarithm of the binomial coefficient.</p></li>
</ul>
</dd>
</dl>
<div id="logmult" class="function-header">
    <span class="class-name">function</span> <span class="function-name">logmult(counts)</span>
    <a href="../Code/hypergraph_binning.html#logmult" class="source-link">[source]</a>
</div><p><strong>Description</strong>:
Compute the logarithm of the multinomial coefficient over count data.</p>
<p><strong>Parameters</strong>:</p>
<div class="parameter-block">
    (counts)
</div>

<ul class="parameter-list">
    <li><span class="param-name">counts</span>: Count data for which the multinomial coefficient is calculated.</li>
</ul><dl class="simple">
<dt><strong>Returns</strong>:</dt><dd><ul class="simple">
<li><p><strong>float</strong>: Logarithm of the multinomial coefficient.</p></li>
</ul>
</dd>
</dl>
<div id="logOmega" class="function-header">
    <span class="class-name">function</span> <span class="function-name">logOmega(rs, cs, swap=True)</span>
    <a href="../Code/hypergraph_binning.html#logomega" class="source-link">[source]</a>
</div><p><strong>Description</strong>:
Compute the logarithm of the number of non-negative integer matrices with specified row and column sums.</p>
<p><strong>Parameters</strong>:</p>
<div class="parameter-block">
    (rs, cs, swap=True)
</div>

<ul class="parameter-list">
    <li><span class="param-name">rs</span>: Array of row sums.</li>
    <li><span class="param-name">cs</span>: Array of column sums.</li>
    <li><span class="param-name">swap</span>: Boolean to swap the definition of rows and columns for a minor accuracy improvement.</li>
</ul><dl class="simple">
<dt><strong>Returns</strong>:</dt><dd><ul class="simple">
<li><p><strong>float</strong>: Logarithm of the number of non-negative integer matrices.</p></li>
</ul>
</dd>
</dl>
<div id="MDL_hypergraph_binning" class="function-header">
    <span class="class-name">function</span> <span class="function-name">MDL_hypergraph_binning(X, dt, exact=True)</span>
    <a href="../Code/hypergraph_binning.html#mdl-hypergraph-binning" class="source-link">[source]</a>
</div><p><strong>Description</strong>:
Identify the MDL-optimal temporally contiguous partition of event data X at resolution dt.</p>
<p><strong>Parameters</strong>:</p>
<div class="parameter-block">
    (X, dt, exact=True)
</div>

<ul class="parameter-list">
    <li><span class="param-name">X</span>: List of event data entries, each in the form [source, destination, weight, time].</li>
    <li><span class="param-name">dt</span>: Time discretization width.</li>
    <li><span class="param-name">exact</span>: Boolean to indicate whether to use the exact dynamic programming solution or the faster approximate greedy solution.</li>
</ul><dl class="simple">
<dt><strong>Returns</strong>:</dt><dd><ul class="simple">
<li><p><strong>best_MDL/L0</strong>: Compression ratio eta for MDL-optimal temporally contiguous partition of event data X.</p></li>
<li><p><strong>labels</strong>: Partition of the event data into event clusters.</p></li>
<li><p><strong>T</strong>: Number of time steps corresponding to width dt.</p></li>
</ul>
</dd>
</dl>
<div id="DL" class="function-header">
    <span class="class-name">function</span> <span class="function-name">MDL_hypergraph_binning.DL(i, j)</span>
    <a href="../Code/hypergraph_binning.html#mdl-hypergraph-binning" class="source-link">[source]</a>
</div><p><strong>Description</strong>:
Compute the description length for cluster corresponding to the time interval [i,j].</p>
<p><strong>Parameters</strong>:</p>
<div class="parameter-block">
    (i, j)
</div>

<ul class="parameter-list">
    <li><span class="param-name">i</span>: Interval start index.</li>
    <li><span class="param-name">j</span>: Interval end index.</li>
</ul><dl class="simple">
<dt><strong>Returns</strong>:</dt><dd><ul class="simple">
<li><p><strong>float</strong>: Cluster-level description length.</p></li>
</ul>
</dd>
</dl>
</section>
</section>
<section id="demo">
<h2>Demo<a class="headerlink" href="#demo" title="Link to this heading"></a></h2>
<p>The following example demonstrates how to use the <code class="docutils literal notranslate"><span class="pre">MDL_hypergraph_binning</span></code> function on an event dataset <code class="docutils literal notranslate"><span class="pre">X</span></code> with a time step width <code class="docutils literal notranslate"><span class="pre">dt</span></code>.</p>
<section id="example-code">
<h3>Example Code<a class="headerlink" href="#example-code" title="Link to this heading"></a></h3>
<p><strong>Step 1: Import necessary libraries</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">ScholarCodeCollective</span> <span class="k">as</span> <span class="nn">SCC</span>
<span class="kn">from</span> <span class="nn">ScholarCodeCollective.hypergraph_binning</span> <span class="kn">import</span> <span class="n">MDL_hypergraph_binning</span><span class="p">,</span> <span class="n">logOmega</span><span class="p">,</span> <span class="n">logchoose</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">networkx</span> <span class="k">as</span> <span class="nn">nx</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">Counter</span><span class="p">,</span> <span class="n">defaultdict</span>
</pre></div>
</div>
<p><strong>Step 2: Generate synthetic event dataset and choose time discretization</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;1&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mf">0.1</span><span class="p">),(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="s1">&#39;1&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mf">0.2</span><span class="p">),(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="s1">&#39;1&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mf">0.3</span><span class="p">),(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;1&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mf">0.4</span><span class="p">),(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="s1">&#39;1&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mf">0.5</span><span class="p">),</span>
     <span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="s1">&#39;1&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="s1">&#39;2&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;2&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">),(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="s1">&#39;2&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">),(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="s1">&#39;2&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">)]</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mf">0.1</span>
</pre></div>
</div>
<p><strong>Step 3: Run the exact dynamic programming algorithm</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">start_exact</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">results_exact</span> <span class="o">=</span> <span class="n">MDL_hypergraph_binning</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">exact</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">runtime_exact</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_exact</span>
</pre></div>
</div>
<p><strong>Step 4: Run the fast greedy agglomerative algorithm</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">start_greedy</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">results_greedy</span> <span class="o">=</span> <span class="n">MDL_hypergraph_binning</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">exact</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">runtime_greedy</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_greedy</span>
</pre></div>
</div>
<p><strong>Step 5: Display results</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Exact Dynamic Program Results: &#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;     compression ratio =&#39;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">results_exact</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">4</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;     MDL-optimal event partition =&#39;</span><span class="p">,</span> <span class="n">results_exact</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;     number of time steps =&#39;</span><span class="p">,</span> <span class="n">results_exact</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;     runtime =&#39;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">runtime_exact</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Greedy Algorithm Results: &#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;     compression ratio =&#39;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">results_greedy</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">4</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;     MDL-optimal event partition =&#39;</span><span class="p">,</span> <span class="n">results_greedy</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;     number of time steps =&#39;</span><span class="p">,</span> <span class="n">results_greedy</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;     runtime =&#39;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">runtime_greedy</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
</pre></div>
</div>
<p><strong>Step 6: Function to visualize the binning results</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">visualize_binning</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="n">method</span><span class="p">):</span>
    <span class="n">labels</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">times</span> <span class="o">=</span> <span class="p">[</span><span class="n">t</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">X</span><span class="p">]</span>
    <span class="n">pairs</span> <span class="o">=</span> <span class="p">[(</span><span class="n">src</span><span class="p">,</span> <span class="n">dest</span><span class="p">)</span> <span class="k">for</span> <span class="n">src</span><span class="p">,</span> <span class="n">dest</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">X</span><span class="p">]</span>
    <span class="n">times_transformed</span> <span class="o">=</span> <span class="n">times</span>
    <span class="n">unique_nodes</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">src</span> <span class="k">for</span> <span class="n">src</span><span class="p">,</span> <span class="n">dest</span> <span class="ow">in</span> <span class="n">pairs</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">dest</span> <span class="k">for</span> <span class="n">src</span><span class="p">,</span> <span class="n">dest</span> <span class="ow">in</span> <span class="n">pairs</span><span class="p">])))</span>
    <span class="n">node_pos</span> <span class="o">=</span> <span class="p">{</span><span class="n">node</span><span class="p">:</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">node</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">unique_nodes</span><span class="p">)}</span>

    <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;skyblue&#39;</span> <span class="k">if</span> <span class="n">label</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="s1">&#39;lightcoral&#39;</span> <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">]</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">dest</span><span class="p">),</span> <span class="n">time</span><span class="p">,</span> <span class="n">color</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">pairs</span><span class="p">,</span> <span class="n">times_transformed</span><span class="p">,</span> <span class="n">colors</span><span class="p">):</span>
        <span class="n">src_pos</span> <span class="o">=</span> <span class="n">node_pos</span><span class="p">[</span><span class="n">src</span><span class="p">]</span>
        <span class="n">dest_pos</span> <span class="o">=</span> <span class="n">node_pos</span><span class="p">[</span><span class="n">dest</span><span class="p">]</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">time</span><span class="p">,</span> <span class="n">time</span><span class="p">],</span> <span class="p">[</span><span class="n">src_pos</span><span class="p">,</span> <span class="n">dest_pos</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">src_pos</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">src</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">dest_pos</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">dest</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">times_transformed</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">times_transformed</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">node_pos</span><span class="o">.</span><span class="n">values</span><span class="p">())</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">node_pos</span><span class="o">.</span><span class="n">values</span><span class="p">())</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Event Partition in Time Scale with </span><span class="si">{</span><span class="n">method</span><span class="si">}</span><span class="s1"> Dynamic Solution&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;timeline_plot_with_log_transform_</span><span class="si">{</span><span class="n">method</span><span class="si">}</span><span class="s2">.png&quot;</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p><strong>Step 7: Visualize the binning results for the exact dynamic programming</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">visualize_binning</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">results_exact</span><span class="p">,</span> <span class="s1">&#39;exact dynamic programming&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Step 8: Visualize the binning results for the fast greedy agglomerative</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">visualize_binning</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">results_greedy</span><span class="p">,</span> <span class="s1">&#39;fast greedy agglomerative&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="example-output">
<h3>Example Output<a class="headerlink" href="#example-output" title="Link to this heading"></a></h3>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Exact Dynamic Program Results:
    compression ratio = 0.9842
    MDL-optimal event partition = [0 0 0 0 0 0 1 1 1 1]
    number of time steps = 50
    runtime = 0.006
Greedy Algorithm Results:
    compression ratio = 0.9913
    MDL-optimal event partition = [0 0 0 0 0 1 1 1 1 1]
    number of time steps = 50
    runtime = 0.0036
</pre></div>
</div>
<figure class="align-default">
<img alt="Hypergraph binning results for synthetic dataset with exact dynamic programming solution." src="../_images/timeline_plot_with_exact_dynamic_programming.png" />
</figure>
<p>Hypergraph binning results for synthetic dataset with exact dynamic programming solution. The x-axis represents time and the events are plotted with colors indicating event clusters. Events labeled with “0” are partitioned into the first group (light blue), and events labeled with “1” are partitioned into the second group (light red). Each group forms a cohesive hypergraph structure involving the two sets of nodes.</p>
<figure class="align-default">
<img alt="Hypergraph binning results for synthetic dataset with greedy agglomerative solution." src="../_images/timeline_plot_with_fast_greedy_agglomerative.png" />
</figure>
<p>Hypergraph binning results for synthetic dataset with greedy agglomerative solution.</p>
</section>
</section>
<section id="paper-source">
<h2>Paper source<a class="headerlink" href="#paper-source" title="Link to this heading"></a></h2>
<p>If you use this algorithm in your work, please cite:</p>
<p>A. Kirkley, Inference of dynamic hypergraph representations in temporal interaction data. Physical Review E 109, 054306 (2024).
Paper: <a class="reference external" href="https://arxiv.org/abs/2308.16546">https://arxiv.org/abs/2308.16546</a></p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../index.html" class="btn btn-neutral float-left" title="Welcome to PANINIpy’s documentation!" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="population_clustering.html" class="btn btn-neutral float-right" title="Clustering Network Populations" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Baiyue.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>